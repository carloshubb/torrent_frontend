{"version":3,"file":"useAuth-COd_Gpgv.js","sources":["../../../../../../nuxt/dist/app/composables/state.js","../../../../../../../utils/useAuth.js"],"sourcesContent":["import { isRef, toRef } from \"vue\";\nimport { useNuxtApp } from \"../nuxt.js\";\nimport { toArray } from \"../utils.js\";\nconst useStateKeyPrefix = \"$s\";\nexport function useState(...args) {\n  const autoKey = typeof args[args.length - 1] === \"string\" ? args.pop() : void 0;\n  if (typeof args[0] !== \"string\") {\n    args.unshift(autoKey);\n  }\n  const [_key, init] = args;\n  if (!_key || typeof _key !== \"string\") {\n    throw new TypeError(\"[nuxt] [useState] key must be a string: \" + _key);\n  }\n  if (init !== void 0 && typeof init !== \"function\") {\n    throw new Error(\"[nuxt] [useState] init must be a function: \" + init);\n  }\n  const key = useStateKeyPrefix + _key;\n  const nuxtApp = useNuxtApp();\n  const state = toRef(nuxtApp.payload.state, key);\n  if (state.value === void 0 && init) {\n    const initialValue = init();\n    if (isRef(initialValue)) {\n      nuxtApp.payload.state[key] = initialValue;\n      return initialValue;\n    }\n    state.value = initialValue;\n  }\n  return state;\n}\nexport function clearNuxtState(keys) {\n  const nuxtApp = useNuxtApp();\n  const _allKeys = Object.keys(nuxtApp.payload.state).map((key) => key.substring(useStateKeyPrefix.length));\n  const _keys = !keys ? _allKeys : typeof keys === \"function\" ? _allKeys.filter(keys) : toArray(keys);\n  for (const _key of _keys) {\n    const key = useStateKeyPrefix + _key;\n    if (key in nuxtApp.payload.state) {\n      nuxtApp.payload.state[key] = void 0;\n    }\n  }\n}\n","// ~/composables/useAuth.js\r\nimport { ref } from 'vue';\r\n\r\nexport const useUser = () => useState('user', () => null);\r\nexport const useToken = () => useState('token', () => null);\r\n\r\nexport function useAuth() {\r\n  const user = useUser();\r\n  const token = useToken();\r\n\r\n  const isLoggedIn = () => !!token.value;\r\n\r\n  const setAuth = (authUser, authToken) => {\r\n    user.value = authUser;\r\n    token.value = authToken;\r\n\r\n    if (process.client) {\r\n      localStorage.setItem('user', JSON.stringify(authUser));\r\n      localStorage.setItem('token', authToken);\r\n    }\r\n  };\r\n\r\n  const logout = () => {\r\n    user.value = null;\r\n    token.value = null;\r\n\r\n    if (process.client) {\r\n      localStorage.removeItem('user');\r\n      localStorage.removeItem('token');\r\n    }\r\n  };\r\n\r\n  return { user, token, isLoggedIn, setAuth, logout };\r\n}\r\n"],"names":[],"mappings":";;AAGA,MAAM,oBAAoB;AACnB,SAAS,YAAY,MAAM;AAChC,QAAM,UAAU,OAAO,KAAK,KAAK,SAAS,CAAC,MAAM,WAAW,KAAK,IAAG,IAAK;AACzE,MAAI,OAAO,KAAK,CAAC,MAAM,UAAU;AAC/B,SAAK,QAAQ,OAAO;AAAA,EACtB;AACA,QAAM,CAAC,MAAM,IAAI,IAAI;AACrB,MAAI,CAAC,QAAQ,OAAO,SAAS,UAAU;AACrC,UAAM,IAAI,UAAU,6CAA6C,IAAI;AAAA,EACvE;AACA,MAAI,SAAS,UAAU,OAAO,SAAS,YAAY;AACjD,UAAM,IAAI,MAAM,gDAAgD,IAAI;AAAA,EACtE;AACA,QAAM,MAAM,oBAAoB;AAChC,QAAM,UAAU,WAAU;AAC1B,QAAM,QAAQ,MAAM,QAAQ,QAAQ,OAAO,GAAG;AAC9C,MAAI,MAAM,UAAU,UAAU,MAAM;AAClC,UAAM,eAAe,KAAI;AACzB,QAAI,MAAM,YAAY,GAAG;AACvB,cAAQ,QAAQ,MAAM,GAAG,IAAI;AAC7B,aAAO;AAAA,IACT;AACA,UAAM,QAAQ;AAAA,EAChB;AACA,SAAO;AACT;ACzBO,MAAM,UAAU,MAAM,SAAS,QAAQ,MAAM,IAAI;AACjD,MAAM,WAAW,MAAM,SAAS,SAAS,MAAM,IAAI;AAEnD,SAAS,UAAU;AACxB,QAAM,OAAO,QAAA;AACb,QAAM,QAAQ,SAAA;AAEd,QAAM,aAAa,MAAM,CAAC,CAAC,MAAM;AAEjC,QAAM,UAAU,CAAC,UAAU,cAAc;AACvC,SAAK,QAAQ;AACb,UAAM,QAAQ;AAAA,EAMhB;AAEA,QAAM,SAAS,MAAM;AACnB,SAAK,QAAQ;AACb,UAAM,QAAQ;AAAA,EAMhB;AAEA,SAAO,EAAE,MAAM,OAAO,YAAY,SAAS,OAAA;AAC7C;"}