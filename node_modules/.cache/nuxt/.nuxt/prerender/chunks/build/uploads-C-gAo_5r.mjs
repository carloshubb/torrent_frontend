import { H as Head } from './components-CkKCuKad.mjs';
import { ref, reactive, withCtx, unref, createVNode, createBlock, createCommentVNode, createTextVNode, openBlock, Fragment, renderList, toDisplayString, useSSRContext } from 'file://D:/_4_Work/Web/torrent-nuxt/frontend/node_modules/vue/index.mjs';
import { ssrRenderComponent, ssrRenderClass, ssrRenderList, ssrRenderAttr, ssrInterpolate } from 'file://D:/_4_Work/Web/torrent-nuxt/frontend/node_modules/vue/server-renderer/index.mjs';
import _sfc_main$1 from './AppLayout-YcpLZ4jN.mjs';
import dayjs from 'file://D:/_4_Work/Web/torrent-nuxt/frontend/node_modules/dayjs/dayjs.min.js';
import relativeTime from 'file://D:/_4_Work/Web/torrent-nuxt/frontend/node_modules/dayjs/plugin/relativeTime.js';
import { PencilIcon, TrashIcon } from 'file://D:/_4_Work/Web/torrent-nuxt/frontend/node_modules/@heroicons/vue/24/solid/esm/index.js';
import { t as torrentService } from './torrentService-CHqQEqPf.mjs';
import './composables-Dj0Rik_j.mjs';
import './server.mjs';
import 'file://D:/_4_Work/Web/torrent-nuxt/frontend/node_modules/ofetch/dist/node.mjs';
import '../_/renderer.mjs';
import 'file://D:/_4_Work/Web/torrent-nuxt/frontend/node_modules/vue-bundle-renderer/dist/runtime.mjs';
import 'file://D:/_4_Work/Web/torrent-nuxt/frontend/node_modules/h3/dist/index.mjs';
import 'file://D:/_4_Work/Web/torrent-nuxt/frontend/node_modules/ufo/dist/index.mjs';
import 'file://D:/_4_Work/Web/torrent-nuxt/frontend/node_modules/destr/dist/index.mjs';
import '../_/nitro.mjs';
import 'file://D:/_4_Work/Web/torrent-nuxt/frontend/node_modules/hookable/dist/index.mjs';
import 'file://D:/_4_Work/Web/torrent-nuxt/frontend/node_modules/node-mock-http/dist/index.mjs';
import 'file://D:/_4_Work/Web/torrent-nuxt/frontend/node_modules/unstorage/dist/index.mjs';
import 'file://D:/_4_Work/Web/torrent-nuxt/frontend/node_modules/unstorage/drivers/fs.mjs';
import 'file:///D:/_4_Work/Web/torrent-nuxt/frontend/node_modules/nuxt/dist/core/runtime/nitro/utils/cache-driver.js';
import 'file://D:/_4_Work/Web/torrent-nuxt/frontend/node_modules/unstorage/drivers/fs-lite.mjs';
import 'file://D:/_4_Work/Web/torrent-nuxt/frontend/node_modules/ohash/dist/index.mjs';
import 'file://D:/_4_Work/Web/torrent-nuxt/frontend/node_modules/klona/dist/index.mjs';
import 'file://D:/_4_Work/Web/torrent-nuxt/frontend/node_modules/defu/dist/defu.mjs';
import 'file://D:/_4_Work/Web/torrent-nuxt/frontend/node_modules/scule/dist/index.mjs';
import 'file://D:/_4_Work/Web/torrent-nuxt/frontend/node_modules/radix3/dist/index.mjs';
import 'node:fs';
import 'node:url';
import 'file://D:/_4_Work/Web/torrent-nuxt/frontend/node_modules/pathe/dist/index.mjs';
import 'file://D:/_4_Work/Web/torrent-nuxt/frontend/node_modules/unhead/dist/server.mjs';
import 'file://D:/_4_Work/Web/torrent-nuxt/frontend/node_modules/devalue/index.js';
import 'file://D:/_4_Work/Web/torrent-nuxt/frontend/node_modules/unhead/dist/utils.mjs';
import 'file://D:/_4_Work/Web/torrent-nuxt/frontend/node_modules/unctx/dist/index.mjs';
import 'file://D:/_4_Work/Web/torrent-nuxt/frontend/node_modules/vue-router/dist/vue-router.node.mjs';
import 'file://D:/_4_Work/Web/torrent-nuxt/frontend/node_modules/@inertiajs/vue3/dist/index.esm.js';
import './useAuth-COd_Gpgv.mjs';
import 'file://D:/_4_Work/Web/torrent-nuxt/frontend/node_modules/axios/index.js';

const _sfc_main = {
  __name: "uploads",
  __ssrInlineRender: true,
  emits: ["delete", "edit"],
  setup(__props, { emit: __emit }) {
    const showDeleteModal = ref(false);
    const showEditModal = ref(false);
    const itemToDelete = ref(null);
    const currentItem = ref(null);
    const form = reactive({
      name: "",
      description: ""
    });
    dayjs.extend(relativeTime);
    const uploads = ref([]);
    const parseDateString = (str) => {
      const now = dayjs();
      if (dayjs(str, dayjs.ISO_8601, true).isValid()) {
        return dayjs(str);
      }
      str = str.replace(/(\d+)(st|nd|rd|th)/gi, "$1");
      str = str.replace(/'(\d{2})/, "20$1");
      str = str.replace(/\./g, "");
      if (/^\d{1,2}(:\d{2})?(am|pm)$/i.test(str)) {
        return dayjs(
          `${now.format("YYYY-MM-DD")} ${str}`,
          ["YYYY-MM-DD h:mma", "YYYY-MM-DD ha"]
        );
      }
      const formats = [
        "ha MMM D YYYY",
        "h:mma MMM D YYYY",
        "MMM D YYYY ha",
        "MMM D YYYY h:mma",
        "MMM D YYYY"
        // no time
      ];
      return dayjs(str, formats);
    };
    const formatApprovedAt = (dateString) => {
      const date = parseDateString(dateString);
      const now = dayjs();
      if (!date.isValid()) return "Invalid date";
      if (date.isSame(now, "day")) {
        return date.format("h:mma");
      } else {
        return date.format("MMM. D, YYYY");
      }
    };
    const emit = __emit;
    function openEditModal(item) {
      currentItem.value = item;
      form.name = item.name || "";
      form.description = item.detail.description || "";
      showEditModal.value = true;
    }
    function openDeleteModal(item) {
      itemToDelete.value = item;
      showDeleteModal.value = true;
    }
    function closeDeleteModal() {
      showDeleteModal.value = false;
      itemToDelete.value = null;
    }
    function confirmDelete() {
      emit("delete", itemToDelete.value);
      deleteUploadTorrent(itemToDelete.value.id);
      closeDeleteModal();
    }
    async function deleteUploadTorrent(id) {
      torrentService.deleteTorrent(id).then((res) => {
        uploads.value = uploads.value.filter(function(row) {
          return row.id != id;
        });
      }).catch((err) => console.error(err));
    }
    return (_ctx, _push, _parent, _attrs) => {
      const _component_Head = Head;
      _push(`<!--[-->`);
      _push(ssrRenderComponent(_component_Head, { title: "Your Torrents Uploads" }, null, _parent));
      _push(ssrRenderComponent(_sfc_main$1, null, {
        default: withCtx((_, _push2, _parent2, _scopeId) => {
          if (_push2) {
            _push2(`<div class="px-2 md:px-0"${_scopeId}><div class="featured-list bg-gray-800 rounded-lg overflow-hidden shadow-xl mt-6"${_scopeId}><div class="featured-heading bg-gradient-to-r from-orange-400 to-red-500 px-4 py-3 flex items-center"${_scopeId}><h2 class="text-white font-bold"${_scopeId}><span class="featured-icon"${_scopeId}><i class="${ssrRenderClass(_ctx.icon)}"${_scopeId}></i></span> Your Torrents Uploads </h2></div><div class="overflow-x-auto"${_scopeId}><table class="min-w-full"${_scopeId}><thead class="bg-gray-700"${_scopeId}><tr${_scopeId}><th class="text-left px-4 py-1 text-gray-300 font-semibold"${_scopeId}>name</th><th class="hidden md:table-cell text-center px-4 py-1 text-gray-300 font-semibold"${_scopeId}>se </th><th class="hidden md:table-cell text-center px-4 py-1 text-gray-300 font-semibold"${_scopeId}>le </th><th class="hidden md:table-cell text-center px-4 py-1 text-gray-300 font-semibold"${_scopeId}>time </th><th class="hidden md:table-cell text-center px-4 py-1 text-gray-300 font-semibold"${_scopeId}>remove </th></tr></thead><tbody${_scopeId}>`);
            if (uploads.value.length > 0) {
              _push2(`<!--[-->`);
              ssrRenderList(uploads.value, (torrent, index) => {
                _push2(`<tr class="border-b border-gray-700 hover:bg-gray-750 transition-colors cursor-pointer text-xs"${_scopeId}><td class="px-2 py-3"${_scopeId}><div class="flex items-center justify-between"${_scopeId}><div class="flex items-center"${_scopeId}><a${ssrRenderAttr("href", `/sub/${torrent.subcategory_id}/0/`)}${_scopeId}>`);
                if (torrent.subcategory) {
                  _push2(`<button class=""${_scopeId}><i class="${ssrRenderClass(`${torrent.subcategory.icon}`)}"${_scopeId}></i></button>`);
                } else {
                  _push2(`<!---->`);
                }
                _push2(`</a><a${ssrRenderAttr("href", `/torrent/${torrent.id}/${torrent.slug}/`)} class="text-gray-300 hover:text-orange-400 transition-colors ml-3"${_scopeId}>${ssrInterpolate(torrent.name)}</a></div>`);
                if (torrent.comments_count) {
                  _push2(`<span class="bg-gray-500 text-black-900 rounded text-xs font-semibold px-2"${_scopeId}>${ssrInterpolate(torrent.comments_count)}</span>`);
                } else {
                  _push2(`<!---->`);
                }
                _push2(`</div></td><td class="text-center px-2 py-2 hidden md:table-cell"${_scopeId}><span class="bg-green-600 text-white px-1 text-xs rounded"${_scopeId}>${ssrInterpolate(torrent.seeders)}</span></td><td class="text-center px-2 py-2 hidden md:table-cell"${_scopeId}><span class="bg-red-800 text-white px-1 text-xs rounded"${_scopeId}>${ssrInterpolate(torrent.leechers)}</span></td><td class="text-center px-2 py-2 text-gray-400 hidden md:table-cell"${_scopeId}>${ssrInterpolate(formatApprovedAt(torrent.approved_at))}</td><td class="text-center px-2 py-2 text-gray-400 hidden md:table-cell"${_scopeId}><button hidden class="p-2 hover:text-blue-500 transition" title="Edit"${_scopeId}>`);
                _push2(ssrRenderComponent(unref(PencilIcon), { class: "w-5 h-5" }, null, _parent2, _scopeId));
                _push2(`</button><button class="p-2 hover:text-red-500 transition" title="Delete"${_scopeId}>`);
                _push2(ssrRenderComponent(unref(TrashIcon), { class: "w-5 h-5" }, null, _parent2, _scopeId));
                _push2(`</button></td></tr>`);
              });
              _push2(`<!--]-->`);
            } else {
              _push2(`<!---->`);
            }
            if (uploads.value.length == 0) {
              _push2(`<tr${_scopeId}><td colspan="6" class="text-center py-4 text-gray-500"${_scopeId}>No torrents found</td></tr>`);
            } else {
              _push2(`<!---->`);
            }
            _push2(`</tbody></table></div></div></div>`);
            if (showDeleteModal.value) {
              _push2(`<div class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50"${_scopeId}><div class="bg-white rounded-2xl shadow-xl p-6 w-full max-w-md"${_scopeId}><h2 class="text-xl font-semibold text-gray-800 mb-4"${_scopeId}> Delete Confirmation </h2><p class="text-gray-600 mb-6"${_scopeId}> Are you sure you want to delete <span class="font-bold"${_scopeId}>${ssrInterpolate(itemToDelete.value?.name)}</span>? This action cannot be undone. </p><div class="flex justify-end space-x-3"${_scopeId}><button class="px-4 py-2 rounded-lg bg-gray-200 hover:bg-gray-300 text-gray-700"${_scopeId}> Cancel </button><button class="px-4 py-2 rounded-lg bg-red-500 hover:bg-red-600 text-white"${_scopeId}> Delete </button></div></div></div>`);
            } else {
              _push2(`<!---->`);
            }
          } else {
            return [
              createVNode("div", { class: "px-2 md:px-0" }, [
                createVNode("div", { class: "featured-list bg-gray-800 rounded-lg overflow-hidden shadow-xl mt-6" }, [
                  createVNode("div", { class: "featured-heading bg-gradient-to-r from-orange-400 to-red-500 px-4 py-3 flex items-center" }, [
                    createVNode("h2", { class: "text-white font-bold" }, [
                      createVNode("span", { class: "featured-icon" }, [
                        createVNode("i", { class: _ctx.icon }, null, 2)
                      ]),
                      createTextVNode(" Your Torrents Uploads ")
                    ])
                  ]),
                  createVNode("div", { class: "overflow-x-auto" }, [
                    createVNode("table", { class: "min-w-full" }, [
                      createVNode("thead", { class: "bg-gray-700" }, [
                        createVNode("tr", null, [
                          createVNode("th", { class: "text-left px-4 py-1 text-gray-300 font-semibold" }, "name"),
                          createVNode("th", { class: "hidden md:table-cell text-center px-4 py-1 text-gray-300 font-semibold" }, "se "),
                          createVNode("th", { class: "hidden md:table-cell text-center px-4 py-1 text-gray-300 font-semibold" }, "le "),
                          createVNode("th", { class: "hidden md:table-cell text-center px-4 py-1 text-gray-300 font-semibold" }, "time "),
                          createVNode("th", { class: "hidden md:table-cell text-center px-4 py-1 text-gray-300 font-semibold" }, "remove ")
                        ])
                      ]),
                      createVNode("tbody", null, [
                        uploads.value.length > 0 ? (openBlock(true), createBlock(Fragment, { key: 0 }, renderList(uploads.value, (torrent, index) => {
                          return openBlock(), createBlock("tr", {
                            key: index,
                            class: "border-b border-gray-700 hover:bg-gray-750 transition-colors cursor-pointer text-xs"
                          }, [
                            createVNode("td", { class: "px-2 py-3" }, [
                              createVNode("div", { class: "flex items-center justify-between" }, [
                                createVNode("div", { class: "flex items-center" }, [
                                  createVNode("a", {
                                    href: `/sub/${torrent.subcategory_id}/0/`
                                  }, [
                                    torrent.subcategory ? (openBlock(), createBlock("button", {
                                      key: 0,
                                      class: ""
                                    }, [
                                      createVNode("i", {
                                        class: `${torrent.subcategory.icon}`
                                      }, null, 2)
                                    ])) : createCommentVNode("", true)
                                  ], 8, ["href"]),
                                  createVNode("a", {
                                    href: `/torrent/${torrent.id}/${torrent.slug}/`,
                                    class: "text-gray-300 hover:text-orange-400 transition-colors ml-3"
                                  }, toDisplayString(torrent.name), 9, ["href"])
                                ]),
                                torrent.comments_count ? (openBlock(), createBlock("span", {
                                  key: 0,
                                  class: "bg-gray-500 text-black-900 rounded text-xs font-semibold px-2"
                                }, toDisplayString(torrent.comments_count), 1)) : createCommentVNode("", true)
                              ])
                            ]),
                            createVNode("td", { class: "text-center px-2 py-2 hidden md:table-cell" }, [
                              createVNode("span", { class: "bg-green-600 text-white px-1 text-xs rounded" }, toDisplayString(torrent.seeders), 1)
                            ]),
                            createVNode("td", { class: "text-center px-2 py-2 hidden md:table-cell" }, [
                              createVNode("span", { class: "bg-red-800 text-white px-1 text-xs rounded" }, toDisplayString(torrent.leechers), 1)
                            ]),
                            createVNode("td", { class: "text-center px-2 py-2 text-gray-400 hidden md:table-cell" }, toDisplayString(formatApprovedAt(torrent.approved_at)), 1),
                            createVNode("td", { class: "text-center px-2 py-2 text-gray-400 hidden md:table-cell" }, [
                              createVNode("button", {
                                hidden: "",
                                onClick: ($event) => openEditModal(torrent),
                                class: "p-2 hover:text-blue-500 transition",
                                title: "Edit"
                              }, [
                                createVNode(unref(PencilIcon), { class: "w-5 h-5" })
                              ], 8, ["onClick"]),
                              createVNode("button", {
                                onClick: ($event) => openDeleteModal(torrent),
                                class: "p-2 hover:text-red-500 transition",
                                title: "Delete"
                              }, [
                                createVNode(unref(TrashIcon), { class: "w-5 h-5" })
                              ], 8, ["onClick"])
                            ])
                          ]);
                        }), 128)) : createCommentVNode("", true),
                        uploads.value.length == 0 ? (openBlock(), createBlock("tr", { key: 1 }, [
                          createVNode("td", {
                            colspan: "6",
                            class: "text-center py-4 text-gray-500"
                          }, "No torrents found")
                        ])) : createCommentVNode("", true)
                      ])
                    ])
                  ])
                ])
              ]),
              showDeleteModal.value ? (openBlock(), createBlock("div", {
                key: 0,
                class: "fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50"
              }, [
                createVNode("div", { class: "bg-white rounded-2xl shadow-xl p-6 w-full max-w-md" }, [
                  createVNode("h2", { class: "text-xl font-semibold text-gray-800 mb-4" }, " Delete Confirmation "),
                  createVNode("p", { class: "text-gray-600 mb-6" }, [
                    createTextVNode(" Are you sure you want to delete "),
                    createVNode("span", { class: "font-bold" }, toDisplayString(itemToDelete.value?.name), 1),
                    createTextVNode("? This action cannot be undone. ")
                  ]),
                  createVNode("div", { class: "flex justify-end space-x-3" }, [
                    createVNode("button", {
                      onClick: closeDeleteModal,
                      class: "px-4 py-2 rounded-lg bg-gray-200 hover:bg-gray-300 text-gray-700"
                    }, " Cancel "),
                    createVNode("button", {
                      onClick: confirmDelete,
                      class: "px-4 py-2 rounded-lg bg-red-500 hover:bg-red-600 text-white"
                    }, " Delete ")
                  ])
                ])
              ])) : createCommentVNode("", true)
            ];
          }
        }),
        _: 1
      }, _parent));
      _push(`<!--]-->`);
    };
  }
};
const _sfc_setup = _sfc_main.setup;
_sfc_main.setup = (props, ctx) => {
  const ssrContext = useSSRContext();
  (ssrContext.modules || (ssrContext.modules = /* @__PURE__ */ new Set())).add("pages/uploads.vue");
  return _sfc_setup ? _sfc_setup(props, ctx) : void 0;
};

export { _sfc_main as default };
//# sourceMappingURL=uploads-C-gAo_5r.mjs.map
