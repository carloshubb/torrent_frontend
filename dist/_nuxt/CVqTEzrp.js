import w from"./VWedS0MP.js";import{t as x}from"./VEgQ9u1z.js";import{_ as k,y as a,z as i,A as t,K as v,U as F,E as T,T as C,M as d,R as c,V as m,G as U,F as p,I as b,B as g,r as f,o as S,S as I,J as y,D as P,L as h}from"#entry";import"./Hg7DAF47.js";import"./wZdazqJ-.js";const V={name:"BlogPostForm",props:{categories:{type:Array}},data(l){const e=f([]),n=f([]);return e.value=l.categories?l.categories:[],n.value=l.categories?l.categories[0].subcategory:[],{isSubmitting:!1,selectedFilePath:"",showToast:!1,copiedUrl:null,categories:e,sub_categories:n,announceUrls:[{id:1,link:"http://tracker.example.com:8080/announce"},{id:2,link:"http://tracker2.example.com:6969/announce"}],formatTools:["Bold","Italic","Underline","Quote","Code","List","Link","Full Screen","Image","YouTube"],form:{title:"",content:"",language:"",category:"",subcategory:"",tags:"",description:"",torrentFile:null}}},methods:{openFileDialog(){this.$refs.fileInput.click()},handleFileSelect(l){const e=l.target.files[0];e&&(this.form.torrentFile=e,this.selectedFilePath=e.name,this.showToast=!0,setTimeout(()=>this.showToast=!1,3e3))},async submitPost(){this.isSubmitting=!0;try{if(!this.form.title||!this.form.content||!this.form.language||!this.form.category||!this.form.subcategory||!this.form.torrentFile){alert("Please fill in all required fields and select a torrent file");return}const l=new FormData;Object.keys(this.form).forEach(n=>{n==="torrentFile"&&this.form[n]?l.append("torrent_file",this.form[n]):this.form[n]&&n!=="torrentFile"&&l.append(n,this.form[n])});const e=localStorage.getItem("token");try{const n=await x.createTorrent(l);console.log(n)}catch(n){console.error("Upload failed:",n.response?.data||n.message)}if(this.resetForm(),this.isSubmitting=!1,response.success){const n=await response.json();this.resetForm()}else throw new Error("Upload failed")}catch{}finally{this.isSubmitting=!1}},async copyToClipboard(l){try{await navigator.clipboard.writeText(l);const e=this.announceUrls.find(n=>n.link===l);this.copiedUrl=e.id,setTimeout(()=>this.copiedUrl=null,2e3)}catch(e){console.error("Failed to copy: ",e)}},applyFormat(l){const e=this.$refs.descriptionTextarea,n=e.selectionStart,u=e.selectionEnd,o=this.form.description.substring(n,u);let s="";switch(l){case"Bold":s=`<b>${o}</b>`;break;case"Italic":s=`<p style = 'font-style: italic'>${o}</p>`;break;case"Underline":s=`<p style = 'text-decoration: underline'>${o}</p>`;break;case"Quote":s=`<blockquote> ${o}</blockquote>`;break;case"Code":s=`<code>${o}</code>`;break;case"List":s=`<ul><li>${o}</li></ul>`;break;case"Link":s=`<a href = '${o}' ></a>`;break;case"Image":s=`<img src = ${o} />`;break;case"YouTube":s=`<video src = ${o} />`;break;default:s=o}this.form.description=this.form.description.substring(0,n)+s+this.form.description.substring(u),this.$nextTick(()=>{e.focus(),e.setSelectionRange(n+s.length,n+s.length)})},resetForm(){this.form={title:"",content:"",language:"",category:"",sub_categories:"",type:"",tags:"",description:"",torrentFile:null},this.selectedFilePath="",this.$refs.fileInput.value=""},handleCategoryChange(){const l=this.categories.find(e=>e.id===parseInt(this.form.category));this.sub_categories=l?l.subcategory:[],this.form.subcategory=""}},mounted(){}},D={class:"mt-5 bg-slate-600 rounded"},L={class:"max-w-4xl mx-auto"},B={class:"container mx-auto text-white"},E={class:"shadow-lg p-6"},q={class:"flex items-center space-x-3"},N={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},j={class:"grid grid-cols-2 gap-3"},A=["value"],M=["value"],O={class:"border border-gray-300 rounded-md p-3 bg-gray-50"},z={class:"flex flex-wrap gap-2 text-xs mb-3"},R=["onClick"],G={class:"flex justify-end pt-6 border-t border-gray-200"},_=["disabled"];function J(l,e,n,u,o,s){return i(),a("div",D,[t("div",L,[o.showToast?(i(),a("div",{key:0,class:F(["fixed bottom-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg transform transition-all duration-300",{"translate-y-0 opacity-100":o.showToast,"translate-y-2 opacity-0":!o.showToast}])},[...e[12]||(e[12]=[t("div",{class:"flex items-center"},[t("svg",{class:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"})]),T(" URL copied to clipboard! ")],-1)])],2)):v("",!0)]),t("div",B,[t("div",E,[e[26]||(e[26]=t("h2",{class:"text-2xl font-bold mb-6 border-b-2 border-orange-400 pb-2"}," Create New Blog Post ",-1)),t("form",{onSubmit:e[11]||(e[11]=C((...r)=>s.submitPost&&s.submitPost(...r),["prevent"])),class:"space-y-6"},[t("div",null,[e[13]||(e[13]=t("label",{for:"title",class:"block text-sm font-semibold mb-2"},"Title",-1)),d(t("input",{type:"text",id:"title","onUpdate:modelValue":e[0]||(e[0]=r=>o.form.title=r),class:"w-full px-3 py-2 border text-gray-700 border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-colors",placeholder:"Enter post title",required:""},null,512),[[c,o.form.title]])]),t("div",null,[e[14]||(e[14]=t("label",{for:"torrentFile",class:"block text-sm font-semibold mb-2"},"Torrent File",-1)),t("div",q,[t("input",{type:"file",ref:"fileInput",id:"torrentFile",onChange:e[1]||(e[1]=(...r)=>s.handleFileSelect&&s.handleFileSelect(...r)),accept:".torrent",class:"hidden text-gray-700"},null,544),d(t("input",{type:"text","onUpdate:modelValue":e[2]||(e[2]=r=>o.selectedFilePath=r),readonly:"",class:"flex-1 px-3 py-2 border text-gray-700 border-gray-300 rounded-md shadow-sm bg-gray-50 focus:outline-none",placeholder:"No file selected"},null,512),[[c,o.selectedFilePath]]),t("button",{type:"button",onClick:e[3]||(e[3]=(...r)=>s.openFileDialog&&s.openFileDialog(...r)),class:"bg-orange-400 hover:bg-orange-500 text-white font-bold px-4 py-2 rounded transition-colors"}," Browse ")]),e[15]||(e[15]=t("p",{class:"text-xs mt-1"},"Select a .torrent file to upload",-1))]),t("div",null,[e[16]||(e[16]=t("label",{for:"content",class:"block text-sm font-semibold mb-2"},"Content Text",-1)),d(t("textarea",{id:"content","onUpdate:modelValue":e[4]||(e[4]=r=>o.form.content=r),rows:"6",class:"w-full px-3 py-2 border text-gray-700 border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-colors resize-vertical",placeholder:"Enter your blog post content here...",required:""},null,512),[[c,o.form.content]])]),t("div",N,[t("div",null,[e[18]||(e[18]=t("label",{for:"language",class:"block text-sm font-semibold mb-2"},"Language",-1)),d(t("select",{id:"language","onUpdate:modelValue":e[5]||(e[5]=r=>o.form.language=r),class:"w-full px-3 py-2 text-gray-700 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-colors",required:""},[...e[17]||(e[17]=[U('<option value="" data-v-410278e3>Choose language</option><option value="english" data-v-410278e3>English</option><option value="spanish" data-v-410278e3>Spanish</option><option value="french" data-v-410278e3>French</option><option value="german" data-v-410278e3>German</option><option value="chinese" data-v-410278e3>Chinese</option><option value="japanese" data-v-410278e3>Japanese</option>',7)])],512),[[m,o.form.language]])]),t("div",null,[t("div",j,[t("div",null,[e[20]||(e[20]=t("label",{for:"category",class:"block text-sm font-semibold mb-2"},"Category",-1)),d(t("select",{id:"category","onUpdate:modelValue":e[6]||(e[6]=r=>o.form.category=r),onChange:e[7]||(e[7]=(...r)=>s.handleCategoryChange&&s.handleCategoryChange(...r)),class:"w-full text-gray-700 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-colors",required:""},[e[19]||(e[19]=t("option",{value:""},"Choose One",-1)),(i(!0),a(p,null,b(o.categories,r=>(i(),a("option",{key:r.id,value:r.id},g(r.name),9,A))),128))],544),[[m,o.form.category]])]),t("div",null,[e[22]||(e[22]=t("label",{for:"type",class:"block text-sm font-semibold mb-2"},"Type",-1)),d(t("select",{id:"subcategory","onUpdate:modelValue":e[8]||(e[8]=r=>o.form.subcategory=r),class:"w-full px-3 py-2 border text-gray-700 border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-colors",required:""},[e[21]||(e[21]=t("option",{value:""},"Choose sub category",-1)),(i(!0),a(p,null,b(o.sub_categories,r=>(i(),a("option",{key:r.value,value:r.id},g(r.name),9,M))),128))],512),[[m,o.form.subcategory]])])])])]),t("div",null,[e[23]||(e[23]=t("label",{for:"tags",class:"block text-sm font-semibold mb-2"},"Tags",-1)),d(t("input",{type:"text",id:"tags","onUpdate:modelValue":e[9]||(e[9]=r=>o.form.tags=r),class:"w-full text-gray-700 bg-white px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-colors",placeholder:"Enter tags separated by commas"},null,512),[[c,o.form.tags]]),e[24]||(e[24]=t("p",{class:"text-xs mt-1"},"Use commas to separate multiple tags (e.g., web design, css, html)",-1))]),t("div",null,[e[25]||(e[25]=t("label",{for:"description",class:"block text-sm font-semibold mb-2"},"Format Description",-1)),t("div",O,[t("div",z,[(i(!0),a(p,null,b(o.formatTools,r=>(i(),a("button",{type:"button",key:r,onClick:Y=>s.applyFormat(r),class:"px-2 py-1 bg-gray-500 text-white hover:bg-gray-400 rounded transition-colors"},g(r),9,R))),128))]),d(t("textarea",{ref:"descriptionTextarea","onUpdate:modelValue":e[10]||(e[10]=r=>o.form.description=r),rows:"4",class:"w-full px-3 py-2 text-gray-700 border-2 bg-white rounded focus:outline-none focus:ring-2 focus:ring-orange-500 resize-vertical",placeholder:"Enter formatted description here..."},null,512),[[c,o.form.description]])])]),t("div",G,[t("button",{type:"submit",disabled:o.isSubmitting,class:"bg-gradient-to-r from-orange-500 to-red-600 hover:from-orange-600 hover:to-red-700 disabled:opacity-50 disabled:cursor-not-allowed text-white font-semibold py-3 px-8 rounded-lg shadow-lg transform hover:scale-105 transition-all duration-200 focus:outline-none focus:ring-4 focus:ring-orange-300"},g(o.isSubmitting?"UPLOADING...":"UPLOAD"),9,_)])],32)])])])}const Q=Object.assign(k(V,[["render",J],["__scopeId","data-v-410278e3"]]),{__name:"TorrentAdminUpload"}),$={__name:"upload",setup(l){const e=I(),n=f([]),u=f(!1);async function o(){try{const s=await x.get("/torrents/categorydata");n.value=s.data.data}catch(s){console.error("Failed to fetch torrents:",s)}}return S(()=>{const s=localStorage.getItem("token");u.value=!!s,u.value==!1&&e.push("/login"),o()}),(s,r)=>(i(),y(w,null,{default:P(()=>[h(n).length>0?(i(),y(Q,{key:0,categories:h(n)},null,8,["categories"])):v("",!0)]),_:1}))}};export{$ as default};
